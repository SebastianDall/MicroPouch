rename(lib_conc = `ng/µL`,
library_plate = rack_barcode) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, rack_barcode, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("tube_row", "tube_column")) %>%
mutate(tube_column = as.numeric(tube_column))
lib_conc_c <- lib_conc %>%
rename(lib_conc = `ng/µL`,
library_plate = PlateID) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, library_plate, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("tube_row", "tube_column")) %>%
mutate(tube_column = as.numeric(tube_column))
lib_conc_c <- lib_conc %>%
rename(lib_conc = `ng/µL`,
library_plate = PlateID) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, library_plate, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("new_row", "new_column")) %>%
mutate(tube_column = as.numeric(tube_column))
lib_conc_c <- lib_conc %>%
rename(lib_conc = `ng/µL`,
library_plate = PlateID) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, library_plate, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("new_row", "new_column")) %>%
mutate(tube_column = as.numeric(new_column))
lib_conc_c <- lib_conc %>%
rename(lib_conc = `ng/µL`,
library_plate = PlateID) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, library_plate, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("new_row", "new_column")) %>%
mutate(new_column = as.numeric(new_column))
d_redo <- left_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
View(d_redo)
d_redo <- redo_7_8 %>%
select(-c("LibID", "pool_ng", "lib_conc")) %>%
right_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
diff(colnames(ext_conc), colnames(d_redo))
setdiff(colnames(ext_conc), colnames(d_redo))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% d_redo$barcode) %>%
bind_rows(d_redo)
View(ext_tmp)
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% d_redo$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~rack_barcode) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
ext_tmp %>%
filter(!is.na(lib_conc)) %>%
group_by(library_plate) %>%
summarise(samples = n())
View(ext_conc)
d_redo <- redo_7_8 %>%
select(-c("LibID", "pool_ng", "lib_conc")) %>%
full_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% d_redo$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% d_redo$barcode)
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode)$barcode))
filter(d_redo, !is.na(barcode))$barcode
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode)
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
write_csv(ext_tmp, file = "../data/metagenomes_lab/220531_metagenome_libraries.csv")
length(filter(ext_tmp, !is.na(barcode) & !is.na(lib_conc)))
length(filter(ext_tmp, !is.na(barcode) & !is.na(lib_conc))$barcode)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(Sample_barcode, LibID, new_row, new_column, lib_conc, Vsample, pool_ng)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_row, new_column, lib_conc, Vsample, pool_ng)
View(lib1_pool)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_row, new_column, lib_conc, Vsample, pool_ng) %>%
arrange(new_row, new_column)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_row, new_column, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row)
libs <- unique(ext_tmp$library_plate)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc,
source_well = paste0(new_row, new_column)) %>%
select(sample_barcode, LibID, source_well, lib_conc, Vsample, pool_ng) %>%
arrange(source_well)
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, source_well, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row) %>%
mutate(source_well = paste0(new_row, new_column))
lib1_pool <- ext_tmp %>%
filter(library_plate == "LIB00001") %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_column, new_row, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row) %>%
mutate(source_well = paste0(new_row, new_column))
libs <- grep("[7-8]", libs, invert = T, value = T)
libs
libs
View(lib_conc)
libs <- unique(ext_tmp$library_plate)
libs
lib7_8 <- read_csv("../data/LIB_redo/LIB_7_8_picking.csv") %>%
select(sample_barcode:new_column)
redo_7_8 <- lib7_8 %>%
select(!c(tube_row, tube_column)) %>%
left_join(ext_conc, by = c("sample_barcode", "rack_barcode"))
write_csv(redo_7_8, "../data/LIB_redo/redo_7_8.csv")
redo_7_8 <- read_csv("../data/LIB_redo/redo_7_8.csv")
View(redo_7_8)
d_redo <- redo_7_8 %>%
select(-c("LibID", "pool_ng", "lib_conc")) %>%
full_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
write_csv(ext_tmp, file = "../data/metagenomes_lab/220531_metagenome_libraries.csv")
ext_tmp %>%
filter(!is.na(lib_conc)) %>%
group_by(library_plate) %>%
summarise(samples = n())
View(ext_tmp)
x <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
group_by(library_plate) %>%
summarise(samples = n())
sum(x$samples)
View(ext_tmp)
libs <- unique(ext_tmp$library_plate)
libs
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
libs <- unique(ext_tmp$library_plate)
libs
libs <- grep("[7-8,NA]", libs, invert = T, value = T)
libs
libs <- grep("[7-8][NA]", libs, invert = T, value = T)
libs <- grep("NA", libs, invert = T, value = T)
libs <- unique(ext_tmp$library_plate)
libs <- grep("[7-8]", libs, invert = T, value = T)
libs <- grep("NA", libs, invert = T, value = T)
libs <- grep(NA, libs, invert = T, value = T)
libs <- grep("[7-8]", libs, invert = T, value = T)
libs <- unique(ext_tmp$library_plate)
libs <- grep("[7-8]", libs, invert = T, value = T)
libs <- grep(NA, libs, invert = T, value = T)
libs <- !is.na(libs)
libs <- unique(ext_tmp$library_plate)
libs <- grep("[7-8]", libs, invert = T, value = T)
libs <- libs[!is.na(libs)]
lib = libs[1]
pool <- ext_tmp %>%
filter(library_plate == lib) %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_column, new_row, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row) %>%
mutate(source_well = paste0(new_row, new_column))
View(pool)
length(unique(pool$sample_barcode))
508-9-7-5-7-7-7-4-4
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row)) %>%
filter(LibID != "LIB-MP001-C12")
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row)) %>%
filter(LibID != "LIB-MP001-C12")
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row))
ext_tmp_2 <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row)) %>%
filter(LibID != "LIB-MP001-C12")
!ext_tmp_2$LibID %in% ext_tmp$LibID
unique(!ext_tmp_2$LibID %in% ext_tmp$LibID)
unique(!ext_tmp$LibID %in% ext_tmp_2$LibID)
ext_tmp$LibID[!ext_tmp$LibID %in% ext_tmp_2$LibID]
libs <- unique(ext_tmp$library_plate)
libs
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row)) %>%
filter(LibID != "LIB-MP001-C12")
libs <- unique(ext_tmp$library_plate)
libs
libs <- grep("[7-8]", libs, invert = T, value = T)
pool <- ext_tmp %>%
filter(library_plate == lib) %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_column, new_row, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row) %>%
mutate(source_well = paste0(new_row, new_column))
libs <- unique(ext_tmp$library_plate)
for (lib in libs) {
pool <- ext_tmp %>%
filter(library_plate == lib) %>%
mutate(Vsample = pool_ng / lib_conc) %>%
select(sample_barcode, LibID, new_column, new_row, lib_conc, Vsample, pool_ng) %>%
arrange(new_column, new_row) %>%
mutate(source_well = paste0(new_row, new_column))
write_csv(pool, paste0("../data/metagenomes_lab/I-DOT pools/",lib,".csv"))
}
ext_conc <- read_csv("../data/EXT_conc/EXT_ALL.csv") %>%
rename(patient = person,
fecal_donation_number = batch_number) %>%
mutate(project = ifelse(grepl("PaPr", sample_barcode), "MP",
ifelse(grepl("PaOp", sample_barcode), "OP",
ifelse(grepl("PaNP", sample_barcode), "NP", NA))))
redo_7_8 <- read_csv("../data/LIB_redo/redo_7_8.csv")
d_redo <- redo_7_8 %>%
select(-c("LibID", "pool_ng", "lib_conc")) %>%
full_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
files_lib <- list.files("../data/LIB_redo/", full.names = T, pattern = "*.xlsx")
lib_conc <- tibble()
for (f in files_lib) {
lib_tmp <- read_excel(f, range = "A11:F105")
lib_conc <- bind_rows(lib_conc, lib_tmp)
}
lib_conc_c <- lib_conc %>%
rename(lib_conc = `ng/µL`,
library_plate = PlateID) %>%
filter(!lib_conc < 0) %>%
mutate(pool_ng = lib_conc * Vsample) %>%
select(LibID, library_plate, WellID , lib_conc, pool_ng) %>%
separate(WellID, sep ="(?<=[A-Za-z])(?=[0-9])", into = c("new_row", "new_column")) %>%
mutate(new_column = as.numeric(new_column))
d_redo <- redo_7_8 %>%
select(-c("LibID", "pool_ng", "lib_conc")) %>%
full_join(lib_conc_c, redo_7_8, by = c("library_plate", "new_row", "new_column"))
ext_tmp <- ext_conc %>%
mutate(library_plate = gsub("EXT", "LIB", rack_barcode)) %>%
filter(!barcode %in% filter(d_redo, !is.na(barcode))$barcode) %>%
bind_rows(d_redo) %>%
mutate(new_column = ifelse(is.na(new_column), tube_column, new_column),
new_row = ifelse(is.na(new_row), tube_row, new_row)) %>%
filter(LibID != "LIB-MP001-C12")
ext_tmp$LibID[!ext_tmp$LibID %in% ext_tmp_2$LibID]
gg_lib <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
View(ext_tmp)
ext_tmp %>%
filter(!is.na(barcode))
ext_tmp %>%
filter(is.na(barcode))
np <- ext_tmp %>%
filter(is.na(barcode))
View(np)
np <- ext_tmp %>%
filter(is.na(barcode)) %>%
group_by(library_plate) %>%
summarise(samples = n())
np
sp <- ext_tmp %>%
filter(!is.na(barcode)) %>%
group_by(library_plate) %>%
summarise(samples = n())
sp
sp <- ext_tmp %>%
filter(!is.na(barcode))
all(unique(sp$barcode))
unique(sp$barcode)
length(unique(sp$barcode))
gg_lib <- ext_conc %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
tube_row = fct_rev(tube_row)) %>%
ggplot(aes(x = tube_column, y = tube_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~rack_barcode) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib
gg_lib_b <- ext_conc %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
tube_row = fct_rev(tube_row)) %>%
ggplot(aes(x = tube_column, y = tube_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~rack_barcode) +
scale_x_discrete(expand = c(0, 0),position = 'top')
gg_lib_a <- ext_tmp %>%
filter(!is.na(lib_conc)) %>%
mutate(pool_ng = round(pool_ng, 2),
new_row = fct_rev(new_row)) %>%
ggplot(aes(x = new_column, y = new_row, fill = pool_ng, label = pool_ng)) +
geom_tile(color = "white") +
geom_text(color = "white") +
scale_fill_gradient(low = "red4", high = "green4") +
facet_wrap(.~library_plate) +
scale_x_discrete(expand = c(0, 0),position = 'top')
ggarrange(gg_lib_b, gg_lib_a, ncol = 1 )
sp <- ext_tmp %>%
filter(!is.na(barcode))%>%
group_by(library_plate) %>%
summarise(samples = n())
sp
sp <- ext_tmp %>%
group_by(library_plate) %>%
summarise(samples = n())
sp
167+174+166
40.92*150/5
-150
40.92*150/5 - 150
40.92*150/1200
40.92*150/1150
1150/15
View(ext_tmp)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_sub("LIB", library_plate,LibID))
?str_sub
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate))
View(ill)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
index_well = paste0(new_row,new_column))
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
index_well = paste0(new_row,new_column)) %>%
arrange(library_plate, new_column, new_row)
str_length(ext_tmp$new_column)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = if_else(str_length(new_colum) == 1, true = paste0(0,new_column), false = new_column),
index_well = paste0(new_row,new_column)) %>%
arrange(library_plate, new_column, new_row)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = if_else(str_length(new_column) == 1, true = paste0(0,new_column), false = new_column),
index_well = paste0(new_row,new_column)) %>%
arrange(library_plate, new_column, new_row)
ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = if_else(str_length(new_column) == 1, true = paste0(0,new_column), false = new_column),
index_well = paste0(new_row,new_column))
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = if_else(str_length(new_column) == 1, true = paste0("0",new_column), false = new_column),
index_well = paste0(new_row,new_column)) %>%
arrange(library_plate, new_column, new_row)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = as.character(new_column),
new_column = if_else(str_length(new_column) == 1, true = paste0("0",new_column), false = new_column),
index_well = paste0(new_row,new_column)) %>%
arrange(library_plate, new_column, new_row)
ill <- ext_tmp %>%
select(LibID, library_plate, new_row, new_column) %>%
mutate(Sample_ID = str_replace(LibID, "LIB", library_plate),
new_column = as.character(new_column),
new_column = if_else(str_length(new_column) == 1, true = paste0("0",new_column), false = new_column),
index_well = paste0(new_row,new_column),
sample = "sample") %>%
arrange(library_plate, new_column, new_row) %>%
select(Sample_ID, sample, index_well)
write_csv(ill, "../data/metagenomes_lab/sample_sheet.csv")
