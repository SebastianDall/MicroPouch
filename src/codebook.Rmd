---
title: "codebook"
author: "Sebastian MÃ¸lvang Dall"
date: '2022-06-23'
output: html_document
---





```{r}
library(haven)
library(tidyverse)
library(sjlabelled)
```





```{r}
data <- read_dta(file = "../data/metadata/stata/metadata_mp.dta")

metadata <- read_delim("../data/metadata/MicroPouch_DATA_2022-06-21_1300.csv", delim = ";")
```

```{r}
codebook <- map_df(data, function(x) attributes(x)$label) %>% 
  gather(key = Code, value = Label) %>% 
  mutate(values = get_labels(data))


simple_codebook <- get_labels(data) %>% as_tibble()
```


```{r}
df <- data %>% 
  mutate(study_id = as.character(study_id)) %>% 
  mutate(study_id = if_else(nchar(study_id) == 1, paste0("pt00",study_id),paste0("pt0",study_id))) %>% 
  bind_rows(metadata_op)
```

